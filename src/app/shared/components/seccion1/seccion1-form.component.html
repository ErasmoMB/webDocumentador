<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">{{ SECCION1_TEMPLATES.seccionInfoProyecto }}</h4>
    
    <div class="form-field">
      <label class="label">{{ SECCION1_TEMPLATES.labelNombreProyecto }} <span class="required">*</span></label>
      <input 
        type="text" 
        class="input" 
        [placeholder]="SECCION1_TEMPLATES.placeholderNombreProyecto"
        [ngModel]="projectName.value() === '____' ? '' : projectName.value()"
        (ngModelChange)="projectName.update($event)">
    </div>
  </div>

  <div class="form-group-section">
    <h4 class="section-title">{{ SECCION1_TEMPLATES.seccionCargarDatos }}</h4>
    
    <div class="form-field">
      <label class="label">{{ SECCION1_TEMPLATES.labelSubirUBIGEO }} <span class="required">*</span></label>
      <div class="file-upload-wrapper">
        <input 
          type="file" 
          id="jsonFileInput" 
          accept=".json" 
          (change)="onJSONFileSelected($event)"
          style="display: none;">
        <button 
          type="button" 
          class="btn btn-secondary" 
          (click)="selectJSONFile()">
          {{ SECCION1_TEMPLATES.botonSeleccionarArchivo }}
        </button>
        <span *ngIf="jsonFileNameSignal()" class="file-name">{{ jsonFileNameSignal() }}</span>
        <span *ngIf="!jsonFileNameSignal()" class="file-name">{{ SECCION1_TEMPLATES.mensajeArchivoNoSeleccionado }}</span>
      </div>
      <small class="form-hint">{{ SECCION1_TEMPLATES.hintSeleccionarJSON }}</small>
    </div>

    <div class="form-field" *ngIf="centrosPobladosJSONSignal().length > 0">
      <label class="label">{{ SECCION1_TEMPLATES.labelInformacionGeografica }}</label>
      <div class="form-row">
        <!-- COMBO DEPARTAMENTO -->
        <div class="form-field">
          <label class="label">{{ SECCION1_TEMPLATES.labelDepartamento }} <span class="required">*</span></label>
          <select 
            class="input"
            [ngModel]="departamentoSeleccionado.value()"
            (ngModelChange)="departamentoSeleccionado.update($event); onDptoChange()">
            <option value="" disabled>-- Selecciona --</option>
            <option *ngFor="let dpto of dptoOptions()" [value]="dpto">{{ dpto }}</option>
          </select>
          <small class="form-hint">{{ SECCION1_TEMPLATES.hintGeoAutomatica }}</small>
        </div>
        <!-- COMBO PROVINCIA (CASCADA) -->
        <div class="form-field">
          <label class="label">{{ SECCION1_TEMPLATES.labelProvincia }} <span class="required">*</span></label>
          <select 
            class="input"
            [ngModel]="provinciaSeleccionada.value()"
            (ngModelChange)="provinciaSeleccionada.update($event); onProvChange()"
            [disabled]="!departamentoSeleccionado.value()">
            <option value="" disabled>-- Selecciona --</option>
            <option *ngFor="let prov of provOptions()" [value]="prov">{{ prov }}</option>
          </select>
          <small class="form-hint">{{ SECCION1_TEMPLATES.hintGeoAutomatica }}</small>
        </div>
        <!-- COMBO DISTRITO (CASCADA) -->
        <div class="form-field">
          <label class="label">{{ SECCION1_TEMPLATES.labelDistrito }} <span class="required">*</span></label>
          <select 
            class="input"
            [ngModel]="distritoSeleccionado.value()"
            (ngModelChange)="distritoSeleccionado.update($event); onDistritoChange()"
            [disabled]="!provinciaSeleccionada.value()">
            <option value="" disabled>-- Selecciona --</option>
            <option *ngFor="let dist of distOptions()" [value]="dist">{{ dist }}</option>
          </select>
          <small class="form-hint">{{ SECCION1_TEMPLATES.hintGeoAutomatica }}</small>
        </div>
      </div>
    </div>
  </div>

  <div class="form-group-section">
    <h4 class="section-title">{{ SECCION1_TEMPLATES.seccionEditarParrafos }}</h4>
    
    <app-paragraph-editor
      fieldId="parrafoSeccion1_principal"
      [label]="SECCION1_TEMPLATES.labelParrafoPrincipal"
      [hint]="SECCION1_TEMPLATES.hintParrafoPrincipal"
      [rows]="8"
      [value]="parrafoPrincipal.value()"
      (valueChange)="parrafoPrincipal.update($event)">
    </app-paragraph-editor>

    <app-paragraph-editor
      fieldId="parrafoSeccion1_4"
      [label]="SECCION1_TEMPLATES.labelIntroduccionObjetivos"
      [hint]="SECCION1_TEMPLATES.hintIntroduccionObjetivos"
      [rows]="2"
      [value]="parrafoIntroduccion.value()"
      (valueChange)="parrafoIntroduccion.update($event)">
    </app-paragraph-editor>

    <!-- Objetivos DinÃ¡micos -->
    <div class="form-group-section mt-lg">
      <div class="dynamic-list-header">
        <h4 class="section-title">{{ SECCION1_TEMPLATES.labelObjetivos }}</h4>
        <button type="button" class="btn btn--add" (click)="agregarObjetivo()">
          {{ SECCION1_TEMPLATES.botonAgregar }}
        </button>
      </div>
      
      <div *ngFor="let objetivo of objetivosSeccion1.value(); let i = index; trackBy: trackByIndex" class="dynamic-list-item">
        <div class="dynamic-list-item-header">
          <label class="label">{{ SECCION1_TEMPLATES.labelObjetivoN }} {{ i + 1 }}</label>
          <button 
            type="button" 
            class="btn btn--remove" 
            (click)="eliminarObjetivo(i)"
            *ngIf="objetivosSeccion1.value().length > 1">
            {{ SECCION1_TEMPLATES.botonEliminar }}
          </button>
        </div>
        <textarea 
          class="input"
          [ngModel]="objetivo"
          (ngModelChange)="actualizarObjetivo(i, $event)"
          rows="3"
          [placeholder]="SECCION1_TEMPLATES.placeholderObjetivo"></textarea>
      </div>
    </div>

    <div class="form-field mt-lg">
      <label class="label">{{ SECCION1_TEMPLATES.labelFotografias }}</label>
      <app-image-upload
        [fotografias]="fotografiasFormMulti"
        [sectionId]="seccionId"
        [photoPrefix]="PHOTO_PREFIX"
        [permitirMultiples]="true"
        [labelTitulo]="SECCION1_TEMPLATES.labelFotoTituloCompleto"
        [labelFuente]="SECCION1_TEMPLATES.labelFotoFuenteCompleto"
        [labelImagen]="SECCION1_TEMPLATES.labelFotoImagenCompleto"
        [placeholderTitulo]="SECCION1_TEMPLATES.placeholderFotoTitulo"
        [placeholderFuente]="SECCION1_TEMPLATES.placeholderFotoFuente"
        [tituloDefault]="SECCION1_TEMPLATES.tituloFotoDefault"
        [fuenteDefault]="SECCION1_TEMPLATES.fuenteFotoDefault"
        [requerido]="false"
        (fotografiasChange)="onFotografiasChange($event)">
      </app-image-upload>
    </div>
  </div>
</div>

