<div *ngIf="!modoFormulario">
<h5>A.1.9. Indicadores de salud</h5>

<p style="margin-bottom: 10px;"><strong>a. Natalidad y Mortalidad</strong></p>
<div *ngIf="datos.parrafoSeccion13_natalidad_mortalidad_completo; else natalidadMortalidadCompletoDefault" class="text-justify" [innerHTML]="formatearParrafo(datos.parrafoSeccion13_natalidad_mortalidad_completo)"></div>
<ng-template #natalidadMortalidadCompletoDefault>
    <p class="text-justify">El presente ítem proporciona una visión crucial sobre las dinámicas demográficas, reflejando las tendencias en el crecimiento poblacional. De los datos obtenidos en el Puesto de Salud <span [appDataSource]="'section'">{{ datos.grupoAISD || 'Ayroca' }}</span> durante el trabajo de campo, se obtiene que en el año 2023 solo ocurrió un nacimiento, mientras que para el 2024 (hasta el 13 de noviembre) se dieron un total de tres (03) nacimientos.</p>
    <p class="text-justify">Respecto a la mortalidad, según la misma fuente, se obtiene que en el año 2023 se registró un fallecimiento, por suicidio; mientras que para el 2024 no ocurrieron decesos dentro de la CC <span [appDataSource]="'section'">{{ datos.grupoAISD || '____' }}</span>, hasta la fecha indicada.</p>
</ng-template>

<app-table-wrapper title="Indicadores de natalidad y mortalidad – CC {{ datos.grupoAISD || 'Ayroca' }}" sectionId="3.1.4.A.1.9">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Año</th>
            <th class="table-header">Natalidad</th>
            <th class="table-header">Mortalidad</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of (datos.natalidadMortalidadTabla || [])">
            <td class="table-cell"><span *ngIf="item.anio && item.anio !== '____'" [appDataSource]="'manual'">{{ item.anio }}</span><span *ngIf="!item.anio || item.anio === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.natalidad !== undefined && item.natalidad !== '____'" [appDataSource]="'manual'">{{ item.natalidad }}</span><span *ngIf="item.natalidad === undefined || item.natalidad === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.mortalidad !== undefined && item.mortalidad !== '____'" [appDataSource]="'manual'">{{ item.mortalidad }}</span><span *ngIf="item.mortalidad === undefined || item.mortalidad === '____'">____</span></td>
        </tr>
        <tr *ngIf="!datos.natalidadMortalidadTabla || datos.natalidadMortalidadTabla.length === 0">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">Fuente:<span [appDataSource]="'manual'">GEADES (2024)</span></p>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>b. Morbilidad</strong></p>
<div *ngIf="datos.parrafoSeccion13_morbilidad_completo; else morbilidadCompletoDefault" class="text-justify" [innerHTML]="formatearParrafo(datos.parrafoSeccion13_morbilidad_completo)"></div>
<ng-template #morbilidadCompletoDefault>
    <p class="text-justify">De acuerdo con las entrevistas aplicadas durante el trabajo de campo, las autoridades locales y los informantes calificados reportaron que las enfermedades más recurrentes dentro de la CC <span [appDataSource]="'section'">{{ datos.grupoAISD || '____' }}</span> son las infecciones respiratorias agudas (IRAS) y las enfermedades diarreicas agudas (EDAS). Asimismo, se mencionan casos de hipertensión y diabetes, que son más frecuentes en adultos mayores.</p>
    <p class="text-justify">En cuanto a los grupos de morbilidad que se hallan a nivel distrital de <span [appDataSource]="'automatic'">{{ datos.distritoSeleccionado || 'Cahuacho' }}</span> (jurisdicción que abarca a los poblados de la CC <span [appDataSource]="'section'">{{ datos.grupoAISD || '____' }}</span>) para el año 2023, se destaca que las condiciones más frecuentes son las infecciones agudas de las vías respiratorias superiores (1012 casos) y la obesidad y otros de hiperalimentación (191 casos). Para la primera, se reportó un mayor número de casos en el bloque etario de 0-11 años, mientras que para la segunda, el rango de 30-59 años mostró más casos. A continuación, se presenta el cuadro con la cantidad de casos por grupo de morbilidad y bloques etarios dentro del distrito, según el portal REUNIS del MINSA.</p>
</ng-template>

<app-table-wrapper title="Casos por grupos de morbilidad – Distrito {{ datos.distritoSeleccionado || 'Cahuacho' }} (2023)" sectionId="3.1.4.A.1.9">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Grupo de Morbilidad</th>
            <th class="table-header" colspan="5">Bloques etarios</th>
            <th class="table-header">Casos Totales</th>
        </tr>
        <tr>
            <th class="table-header"></th>
            <th class="table-header">0 – 11</th>
            <th class="table-header">12 – 17</th>
            <th class="table-header">18 – 29</th>
            <th class="table-header">30 – 59</th>
            <th class="table-header">60 -></th>
            <th class="table-header"></th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of (datos.morbiliadTabla || datos.morbilidadTabla || [])">
            <td class="table-cell"><span *ngIf="item.grupo && item.grupo !== '____'" [appDataSource]="'automatic'">{{ item.grupo }}</span><span *ngIf="!item.grupo || item.grupo === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.rango0_11 !== undefined && item.rango0_11 !== '____'" [appDataSource]="'automatic'">{{ item.rango0_11 }}</span><span *ngIf="item.rango0_11 === undefined || item.rango0_11 === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.rango12_17 !== undefined && item.rango12_17 !== '____'" [appDataSource]="'automatic'">{{ item.rango12_17 }}</span><span *ngIf="item.rango12_17 === undefined || item.rango12_17 === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.rango18_29 !== undefined && item.rango18_29 !== '____'" [appDataSource]="'automatic'">{{ item.rango18_29 }}</span><span *ngIf="item.rango18_29 === undefined || item.rango18_29 === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.rango30_59 !== undefined && item.rango30_59 !== '____'" [appDataSource]="'automatic'">{{ item.rango30_59 }}</span><span *ngIf="item.rango30_59 === undefined || item.rango30_59 === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.rango60 !== undefined && item.rango60 !== '____'" [appDataSource]="'automatic'">{{ item.rango60 }}</span><span *ngIf="item.rango60 === undefined || item.rango60 === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.casos !== undefined && item.casos !== '____'" [appDataSource]="'automatic'">{{ item.casos }}</span><span *ngIf="item.casos === undefined || item.casos === '____'">____</span></td>
        </tr>
        <tr *ngIf="(!datos.morbiliadTabla || datos.morbiliadTabla.length === 0) && (!datos.morbilidadTabla || datos.morbilidadTabla.length === 0)">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">Fuente:<span [appDataSource]="'manual'">REUNIS (2024)</span></p>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>c. Población afiliada a Seguros de Salud</strong></p>
<p class="text-justify" *ngIf="datos.textoAfiliacionSalud && datos.textoAfiliacionSalud !== '____'">{{ datos.textoAfiliacionSalud }}</p>
<p class="text-justify" *ngIf="!datos.textoAfiliacionSalud || datos.textoAfiliacionSalud === '____'">Dentro de la CC <span [appDataSource]="'section'">{{ datos.grupoAISD || '____' }}</span>, la mayoría de habitantes se encuentran afiliados a algún tipo de seguro de salud. Es así que el Seguro Integral de Salud (SIS) se halla en primer lugar, al abarcar el <span [appDataSource]="'automatic'">{{ datos.porcentajeSIS || '84,44' }}</span> % de la población. A ello le sigue ESSALUD, con un <span [appDataSource]="'automatic'">{{ datos.porcentajeESSALUD || '3,56' }}</span> %. Por otro lado, el <span [appDataSource]="'automatic'">{{ datos.porcentajeSinSeguro || '12,00' }}</span> % de la población no cuenta con ningún tipo de seguro de salud.</p>

<app-table-wrapper title="Población según tipo de seguro de salud afiliado – CC {{ datos.grupoAISD || 'Ayroca' }} (2017)" sectionId="3.1.4.A.1.9">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Categoría</th>
            <th class="table-header">Casos</th>
            <th class="table-header">Porcentaje</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of (datos.afiliacionSaludTabla || datos.seguroSaludTabla || [])">
            <td class="table-cell"><span *ngIf="item.categoria && item.categoria !== '____'" [appDataSource]="'automatic'">{{ item.categoria }}</span><span *ngIf="!item.categoria || item.categoria === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.casos !== undefined && item.casos !== '____'" [appDataSource]="'automatic'">{{ item.casos }}</span><span *ngIf="item.casos === undefined || item.casos === '____'">____</span></td>
            <td class="table-cell"><span *ngIf="item.porcentaje && item.porcentaje !== '____'" [appDataSource]="'automatic'">{{ item.porcentaje }}</span><span *ngIf="!item.porcentaje || item.porcentaje === '____'">____</span></td>
        </tr>
        <tr *ngIf="(!datos.afiliacionSaludTabla || datos.afiliacionSaludTabla.length === 0) && (!datos.seguroSaludTabla || datos.seguroSaludTabla.length === 0)">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">Fuente:<span [appDataSource]="'manual'">Censos Nacionales 2017: XII de Población, VII de Vivienda y III de Comunidades Indígenas</span></p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasSaludIndicadoresVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>
</div>

<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">A.1.9. Indicadores de salud</h4>
    
    <div class="form-field">
      <label class="label">Tabla Natalidad y Mortalidad</label>
      <div class="table-editor">
        <table class="editor-table">
          <thead>
            <tr>
              <th>Año</th>
              <th>Natalidad</th>
              <th>Mortalidad</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of (datos['natalidadMortalidadTabla'] || []); let i = index">
              <td>
                <input type="text" class="table-input" 
                  [value]="item.anio || ''"
                  (input)="actualizarNatalidadMortalidad(i, 'anio', $any($event.target).value)"
                  placeholder="2023">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.natalidad || ''"
                  (input)="actualizarNatalidadMortalidad(i, 'natalidad', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.mortalidad || ''"
                  (input)="actualizarNatalidadMortalidad(i, 'mortalidad', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <button type="button" class="btn-icon" (click)="eliminarNatalidadMortalidad(i)" *ngIf="(datos['natalidadMortalidadTabla'] || []).length > 1" title="Eliminar fila">
                  ×
                </button>
              </td>
            </tr>
            <tr *ngIf="!datos['natalidadMortalidadTabla'] || datos['natalidadMortalidadTabla'].length === 0">
              <td colspan="4" style="text-align: center; padding: 10px;">
                <button type="button" class="btn btn-secondary" (click)="inicializarNatalidadMortalidad()">
                  Agregar Primera Fila
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <button type="button" class="btn btn-secondary" (click)="agregarNatalidadMortalidad()" style="margin-top: 10px;">
        + Agregar Fila
      </button>
    </div>

    <div class="form-field">
      <label class="label">Tabla Morbilidad</label>
      <div class="table-editor" style="overflow-x: auto;">
        <table class="editor-table">
          <thead>
            <tr>
              <th>Grupo de Morbilidad</th>
              <th>0 – 11</th>
              <th>12 – 17</th>
              <th>18 – 29</th>
              <th>30 – 59</th>
              <th>60 -></th>
              <th>Casos Totales</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of (datos['morbilidadTabla'] || datos['morbiliadTabla'] || []); let i = index">
              <td>
                <input type="text" class="table-input" 
                  [value]="item.grupo || ''"
                  (input)="actualizarMorbilidad(i, 'grupo', $any($event.target).value)"
                  placeholder="Infecciones agudas">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.rango0_11 || ''"
                  (input)="actualizarMorbilidad(i, 'rango0_11', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.rango12_17 || ''"
                  (input)="actualizarMorbilidad(i, 'rango12_17', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.rango18_29 || ''"
                  (input)="actualizarMorbilidad(i, 'rango18_29', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.rango30_59 || ''"
                  (input)="actualizarMorbilidad(i, 'rango30_59', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.rango60 || ''"
                  (input)="actualizarMorbilidad(i, 'rango60', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.casos || ''"
                  (input)="actualizarMorbilidad(i, 'casos', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <button type="button" class="btn-icon" (click)="eliminarMorbilidad(i)" *ngIf="((datos['morbilidadTabla'] || datos['morbiliadTabla'] || []).length > 1)" title="Eliminar fila">
                  ×
                </button>
              </td>
            </tr>
            <tr *ngIf="(!datos['morbilidadTabla'] || datos['morbilidadTabla'].length === 0) && (!datos['morbiliadTabla'] || datos['morbiliadTabla'].length === 0)">
              <td colspan="8" style="text-align: center; padding: 10px;">
                <button type="button" class="btn btn-secondary" (click)="inicializarMorbilidad()">
                  Agregar Primera Fila
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <button type="button" class="btn btn-secondary" (click)="agregarMorbilidad()" style="margin-top: 10px;">
        + Agregar Fila
      </button>
    </div>

    <div class="form-field">
      <label class="label">Tabla Afiliación a Seguros de Salud</label>
      <div class="table-editor">
        <table class="editor-table">
          <thead>
            <tr>
              <th>Categoría</th>
              <th>Casos</th>
              <th>Porcentaje</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of (datos['afiliacionSaludTabla'] || datos['seguroSaludTabla'] || []); let i = index">
              <td>
                <input type="text" class="table-input" 
                  [value]="item.categoria || ''"
                  (input)="actualizarAfiliacionSalud(i, 'categoria', $any($event.target).value)"
                  placeholder="SIS">
              </td>
              <td>
                <input type="number" class="table-input" 
                  [value]="item.casos || ''"
                  (input)="actualizarAfiliacionSalud(i, 'casos', $any($event.target).value)"
                  placeholder="0">
              </td>
              <td>
                <input type="text" class="table-input" 
                  [value]="item.porcentaje || ''"
                  (input)="actualizarAfiliacionSalud(i, 'porcentaje', $any($event.target).value)"
                  placeholder="0%">
              </td>
              <td>
                <button type="button" class="btn-icon" (click)="eliminarAfiliacionSalud(i)" *ngIf="((datos['afiliacionSaludTabla'] || datos['seguroSaludTabla'] || []).length > 1) && item.categoria !== 'Total'" title="Eliminar fila">
                  ×
                </button>
              </td>
            </tr>
            <tr *ngIf="(!datos['afiliacionSaludTabla'] || datos['afiliacionSaludTabla'].length === 0) && (!datos['seguroSaludTabla'] || datos['seguroSaludTabla'].length === 0)">
              <td colspan="4" style="text-align: center; padding: 10px;">
                <button type="button" class="btn btn-secondary" (click)="inicializarAfiliacionSalud()">
                  Agregar Filas
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <button type="button" class="btn btn-secondary" (click)="agregarAfiliacionSalud()" style="margin-top: 10px;">
        + Agregar Fila
      </button>
    </div>

    <div class="form-group-section" style="margin-top: 20px;">
      <h4 class="section-title">Editar Párrafos</h4>
      
      <div class="form-field">
        <label class="label">Natalidad y Mortalidad - Texto Completo</label>
        <textarea 
          class="textarea" 
          rows="4"
          [value]="obtenerTextoSeccion13NatalidadMortalidadCompleto()"
          (input)="onFieldChange('parrafoSeccion13_natalidad_mortalidad_completo', $any($event.target).value)"></textarea>
        <small class="form-hint">Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto.</small>
      </div>

      <div class="form-field">
        <label class="label">Morbilidad - Texto Completo</label>
        <textarea 
          class="textarea" 
          rows="6"
          [value]="obtenerTextoSeccion13MorbilidadCompleto()"
          (input)="onFieldChange('parrafoSeccion13_morbilidad_completo', $any($event.target).value)"></textarea>
        <small class="form-hint">Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto.</small>
      </div>
    </div>

    <div class="form-field" style="margin-top: 20px;">
      <label class="label">Fotografías de Indicadores de Salud</label>
      <app-image-upload
        [fotografias]="fotografiasFormMulti"
        [sectionId]="seccionId"
        [photoPrefix]="PHOTO_PREFIX"
        [permitirMultiples]="true"
        labelTitulo="Título de la fotografía"
        labelFuente="Fuente de la fotografía"
        labelImagen="Fotografía - Imagen"
        placeholderTitulo="Ej: Indicadores de Salud"
        placeholderFuente="Ej: GEADES, 2024"
        tituloDefault="Indicadores de Salud"
        fuenteDefault="GEADES, 2024"
        [requerido]="false"
        (fotografiasChange)="onFotografiasChange($event)">
      </app-image-upload>
    </div>
  </div>
</div>

