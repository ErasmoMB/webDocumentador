<!-- ✅ REFACTORIZADO: Seccion2Component contiene vista y formulario básico -->
<!-- La vista completa está en Seccion2ViewComponent (usa este componente) -->
<!-- El formulario completo está en Seccion2FormComponent (usa este componente) -->

<!-- VISTA (cuando modoFormulario = false) -->
<div *ngIf="!modoFormulario">
<h3>3.1.2 Delimitación de las áreas de influencia social</h3>
<div *ngIf="datos.parrafoSeccion2_introduccion; else introduccionDefault" class="text-justify" [innerHTML]="formatearParrafo(datos.parrafoSeccion2_introduccion)"></div>
<ng-template #introduccionDefault>
    <p class="text-justify">En términos generales, la delimitación del ámbito de estudio
        de las áreas de influencia social se hace tomando en consideración a los agentes e instancias sociales,
        individuales y/o colectivas, públicas y/o privadas, que tengan derechos o propiedad sobre el espacio o los
        recursos respecto de los cuales el proyecto de exploración minera tiene incidencia. </p>
    <p class="text-justify">Asimismo, el área de influencia social de un Proyecto tiene en
        consideración a los grupos de interés que puedan ser potencialmente afectadas por el desarrollo de dicho
        proyecto (según La Guía de Relaciones Comunitarias de la DGAAM del MINEM, se denomina "grupos de interés" a
        aquellos grupos humanos que son impactados por dicho Proyecto).</p>
    <p class="text-justify">El criterio social para la delimitación de un área de
        influencia debe tener en cuenta la influencia que el Proyecto pudiera tener sobre el entorno social, que
        será o no ambientalmente impactado, considerando también la posibilidad de generar otro tipo de impactos,
        expectativas, intereses y/o demandas del entorno social.
    </p>
    <p class="text-justify">En base a estos criterios se han identificado las áreas de
        influencia social directa e indirecta:</p>
</ng-template>

<!-- ✅ A. AISD - Grupos Identificados Automáticamente del JSON -->
<h4>A. Áreas de influencia social directa (AISD)</h4>

<!-- Mostrar párrafo AISD: usar signal derivado -->
<div class="text-justify" [innerHTML]="textoAISDFormateado()"></div>

<!-- ✅ B. AISI - Grupos Identificados de Valores DIST Únicos -->
<h4>B. Áreas de influencia social indirecta (AISI)</h4>

<!-- Mostrar párrafo AISI: usar signal derivado -->
<div class="text-justify" [innerHTML]="textoAISIFormateado()"></div>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="fotografiasSeccion2"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>

</div>

<!-- FORMULARIO (cuando modoFormulario = true) -->
<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">Editar Párrafos</h4>
    
    <app-paragraph-editor
      fieldId="parrafoSeccion2_introduccion"
      label="Introducción - Delimitación de Áreas"
      hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
      [rows]="8"
      [value]="obtenerTextoSeccion2Introduccion()"
      (valueChange)="onFieldChange('parrafoSeccion2_introduccion', $event)">
    </app-paragraph-editor>

    <app-paragraph-editor
      fieldId="parrafoSeccion2_aisd_completo"
      label="Área de Influencia Social Directa (AISD)"
      hint="Edite el texto completo de AISD. Deje vacío para usar el texto automáticamente generado."
      [rows]="6"
      [value]="obtenerTextoSeccion2AISDParaEdicion()"
      (valueChange)="onFieldChange('parrafoSeccion2_aisd_completo', $event)">
    </app-paragraph-editor>

    <app-paragraph-editor
      fieldId="parrafoSeccion2_aisi_completo"
      label="Área de Influencia Social Indirecta (AISI)"
      hint="Edite el texto completo de AISI. Deje vacío para usar el texto automáticamente generado."
      [rows]="6"
      [value]="obtenerTextoSeccion2AISIParaEdicion()"
      (valueChange)="onFieldChange('parrafoSeccion2_aisi_completo', $event)">
    </app-paragraph-editor>    <div class="form-field mt-lg">
      <label class="label">Fotografías</label>
      <app-image-upload
        [fotografias]="fotografiasSeccion2"
        [sectionId]="seccionId"
        [photoPrefix]="PHOTO_PREFIX"
        [permitirMultiples]="true"
        labelTitulo="Título de la fotografía"
        labelFuente="Fuente de la fotografía"
        labelImagen="Fotografía - Imagen"
        placeholderTitulo="Ej: Fotografía de la sección 2"
        placeholderFuente="Ej: GEADES, 2024"
        tituloDefault="Sección 2"
        fuenteDefault="GEADES, 2024"
        [requerido]="false"
        (fotografiasChange)="onFotografiasChange($event)">
