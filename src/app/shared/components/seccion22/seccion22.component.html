<div *ngIf="!modoFormulario">
  <h5>B.1.1. Aspectos demográficos</h5>
  <p style="margin-top: 10px; margin-bottom: 6px;"><strong>a. Población según sexo</strong></p>

  <div *ngIf="viewModel$ | async as viewModel">
    <p class="text-justify" *ngIf="viewModel.data.textoDemografiaAISI && viewModel.data.textoDemografiaAISI !== '____'">
      {{ viewModel.data.textoDemografiaAISI }}
    </p>
    <p class="text-justify" *ngIf="!viewModel.data.textoDemografiaAISI || viewModel.data.textoDemografiaAISI === '____'">
      {{ viewModel.texts.demografiaText }}
    </p>

    <app-table-wrapper title="Población por sexo – CP {{ viewModel.data.centroPobladoAISI || 'Cahuacho' }} (2017)" sectionId="3.1.4.B.1.1">
      <app-generic-table
        [data]="viewModel.data.poblacionSexoAISI"
        [config]="poblacionSexoConfig">
      </app-generic-table>
    </app-table-wrapper>
    <p class="source">FUENTE: Censos Nacionales 2017: XII de Población, VII de Vivienda y III de Comunidades Indígenas.</p>

    <p style="margin-top: 10px; margin-bottom: 6px;"><strong>b. Población según grupo etario</strong></p>
    <p class="text-justify" *ngIf="viewModel.data.textoGrupoEtarioAISI && viewModel.data.textoGrupoEtarioAISI !== '____'">
      {{ viewModel.data.textoGrupoEtarioAISI }}
    </p>
    <p class="text-justify" *ngIf="!viewModel.data.textoGrupoEtarioAISI || viewModel.data.textoGrupoEtarioAISI === '____'">
      {{ viewModel.texts.grupoEtarioText }}
    </p>

    <app-table-wrapper title="Población por grupo etario – CP {{ viewModel.data.centroPobladoAISI || 'Cahuacho' }} (2017)" sectionId="3.1.4.B.1.1">
      <app-generic-table
        [data]="viewModel.data.poblacionEtarioAISI"
        [config]="poblacionEtarioConfig">
      </app-generic-table>
    </app-table-wrapper>
    <p class="source">FUENTE: Censos Nacionales 2017: XII de Población, VII de Vivienda y III de Comunidades Indígenas</p>

    <app-image-upload
      *ngIf="fotografiasInstitucionalidadCache.length > 0"
      [fotografias]="fotografiasInstitucionalidadCache"
      [sectionId]="'3.1.4.B.1.1'"
      [photoPrefix]="'fotografiaCahuachoB11'"
      [modoVista]="true"
      [permitirMultiples]="true"
      [mostrarNumero]="true"
      [mostrarTitulo]="true"
      [mostrarFuente]="true">
    </app-image-upload>
  </div>
</div>

<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">B.1.1. Aspectos demográficos</h4>

    <div *ngIf="viewModel$ | async as viewModel">
      <div class="form-group-section" style="margin-top: 20px;">
        <h4 class="section-title">a. Población según sexo</h4>

        <div class="form-group-section" style="margin-top: 15px;">
          <h4 class="section-title">Editar Párrafos</h4>

          <app-paragraph-editor
            fieldId="textoDemografiaAISI"
            label="Población según sexo - Texto Completo"
            hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
            [rows]="4"
            [value]="obtenerTextoDemografiaAISI()"
            (valueChange)="onFieldChange('textoDemografiaAISI', $event)">
          </app-paragraph-editor>
        </div>

        <div class="form-field" style="margin-top: 20px;">
          <label class="label">Tabla Población por Sexo</label>
          <app-dynamic-table
            [datos]="viewModel.data"
            [sectionId]="seccionId"
            [config]="poblacionSexoDynamicConfig"
            [columns]="[
              { field: 'sexo', label: 'Sexo', type: 'text', placeholder: 'Hombre' },
              { field: 'casos', label: 'Casos', type: 'number', placeholder: '0' },
              { field: 'porcentaje', label: 'Porcentaje', type: 'text', placeholder: '0,00 %', readonly: true }
            ]"
            [tablaKey]="'poblacionSexoAISI'"
            [totalKey]="'sexo'"
            (tableUpdated)="onPoblacionSexoTableUpdated()">
          </app-dynamic-table>
        </div>
      </div>

      <div class="form-group-section" style="margin-top: 30px;">
        <h4 class="section-title">b. Población según grupo etario</h4>

        <div class="form-group-section" style="margin-top: 15px;">
          <h4 class="section-title">Editar Párrafos</h4>

          <app-paragraph-editor
            fieldId="textoGrupoEtarioAISI"
            label="Población según grupo etario - Texto Completo"
            hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
            [rows]="4"
            [value]="obtenerTextoGrupoEtarioAISI()"
            (valueChange)="onFieldChange('textoGrupoEtarioAISI', $event)">
          </app-paragraph-editor>
        </div>

        <div class="form-field" style="margin-top: 20px;">
          <label class="label">Tabla Población por Grupo Etario</label>
          <app-dynamic-table
            [datos]="viewModel.data"
            [sectionId]="seccionId"
            [config]="poblacionEtarioDynamicConfig"
            [columns]="[
              { field: 'categoria', label: 'Categoría', type: 'text', placeholder: '0 a 14 años' },
              { field: 'casos', label: 'Casos', type: 'number', placeholder: '0' },
              { field: 'porcentaje', label: 'Porcentaje', type: 'text', placeholder: '0,00 %', readonly: true }
            ]"
            [tablaKey]="'poblacionEtarioAISI'"
            [totalKey]="'categoria'"
            (tableUpdated)="onPoblacionEtarioTableUpdated()">
          </app-dynamic-table>
        </div>
      </div>

      <div class="form-field" style="margin-top: 30px;">
        <label class="label">Fotografías de Demografía AISI</label>
        <app-image-upload
          [fotografias]="fotografiasCahuachoB11FormMulti"
          [sectionId]="'3.1.4.B.1.1'"
          [photoPrefix]="PHOTO_PREFIX_CAHUACHO_B11"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Aspectos demográficos"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Aspectos demográficos"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasChange($event)">
        </app-image-upload>
      </div>
    </div>
  </div>
</div>
