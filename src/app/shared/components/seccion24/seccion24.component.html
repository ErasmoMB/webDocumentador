<div *ngIf="!modoFormulario">
<h5>B.1.3. Actividades económicas de la población</h5>
<p class="text-justify">Las actividades económicas de la población son un reflejo de los patrones de producción, consumo y empleo en una localidad o jurisdicción determinada. En este ítem, se describirá la estructura y la diversidad de las actividades económicas en la capital distrital de <span [appDataSource]="'distritoSeleccionado' | dataSource" [fieldName]="'distritoSeleccionado'">{{ datos.distritoSeleccionado || 'Cahuacho' }}</span>, que forma parte del AISI.</p>
<p class="text-justify">A partir de fuentes oficiales, se exploran las principales fuentes de ingresos y los sectores productivos más relevantes dentro del CP <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> (capital distrital). En esta ocasión, se recurre a los datos provistos por los Censos Nacionales 2017.</p>

<app-table-wrapper title="PEA Ocupada según actividad económica – CP {{ datos.centroPobladoAISI || 'Cahuacho' }} (2017)" sectionId="3.1.4.B.1.3">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Actividad Económica</th>
            <th class="table-header">Casos</th>
            <th class="table-header">Porcentaje</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of getActividadesEconomicasSinTotal()">
            <td class="table-cell cell-from-bd">{{ item.actividad || '____' }}</td>
            <td class="table-cell cell-from-bd">{{ item.casos || '____' }}</td>
            <td class="table-cell cell-percentage">{{ item.porcentaje || '____' }}</td>
        </tr>
        <tr *ngIf="getActividadesEconomicasSinTotal().length > 0">
            <td class="table-cell"><strong>Total</strong></td>
            <td class="table-cell cell-from-bd"><strong>{{ getTotalActividadesEconomicas() }}</strong></td>
            <td class="table-cell cell-percentage"><strong>100,00 %</strong></td>
        </tr>
        <tr *ngIf="getActividadesEconomicasSinTotal().length === 0">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">FUENTE:<span [appDataSource]="'manual'" [fieldName]="'textoActividadesEconomicasAISI'"> Censos Nacionales 2017: XII de Población, VII de Vivienda y III de Comunidades Indígenas.</span></p>
<p class="text-justify" *ngIf="datos.textoActividadesEconomicasAISI && datos.textoActividadesEconomicasAISI !== '____'">{{ datos.textoActividadesEconomicasAISI }}</p>
<p class="text-justify" *ngIf="!datos.textoActividadesEconomicasAISI || datos.textoActividadesEconomicasAISI === '____'">Del cuadro anterior, se aprecia que la actividad económica más frecuente dentro del CP <span [appDataSource]="'section'" [fieldName]="'textoActividadesEconomicasAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> es el grupo "Agricultura, ganadería, silvicultura y pesca" con un <span [appDataSource]="'section'">{{ getPorcentajeAgricultura() }}</span>. Esto se condice con las entrevistas aplicadas en campo, pues los informantes y autoridades declararon que la mayoría de la población se dedica principalmente a la agricultura y a la ganadería. La segunda actividad más frecuente dentro de esta localidad es la de "Administración pública y defensa; planes de seguridad social de afiliación obligatoria" con <span [appDataSource]="'section'">{{ getPorcentajeAdministracion() }}</span>.</p>

<app-image-upload
    *ngIf="fotografiasActividadesEconomicasCache.length > 0"
    [fotografias]="getFotografiasActividadesEconomicasParaImageUpload()"
    [sectionId]="'3.1.4.B.1.3'"
    [photoPrefix]="'fotografiaActividadesEconomicas'"
    [modoVista]="true"
    [permitirMultiples]="true"
    [mostrarNumero]="true"
    [mostrarTitulo]="true"
    [mostrarFuente]="true">
</app-image-upload>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>a. Mercado y comercialización de productos</strong></p>
<p class="text-justify" *ngIf="datos.textoMercadoProductos && datos.textoMercadoProductos !== '____'">{{ datos.textoMercadoProductos }}</p>
<p class="text-justify" *ngIf="!datos.textoMercadoProductos || datos.textoMercadoProductos === '____'">El CP <span [appDataSource]="'section'" [fieldName]="'textoMercadoProductos'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> no cuenta con un mercado formal que centralice las actividades comerciales de la localidad. El comercio en este lugar es incipiente y se lleva a cabo principalmente a través de pequeñas bodegas. Estas bodegas atienden la demanda cotidiana en la localidad, pero la oferta sigue siendo limitada y gran parte de los productos llega desde <span [appDataSource]="'manual'">{{ datos.ciudadOrigenComercio || 'Caravelí' }}</span>.</p>
<p class="text-justify" *ngIf="!datos.textoMercadoProductos || datos.textoMercadoProductos === '____'">Además, la comercialización de productos en <span [appDataSource]="'distritoSeleccionado' | dataSource" [fieldName]="'distritoSeleccionado'">{{ datos.distritoSeleccionado || 'Cahuacho' }}</span> se complementa con la presencia de comerciantes mayoristas que viajan hacia la localidad para comprar y vender productos. La mayoría de estos comerciantes provienen de la ciudad de <span [appDataSource]="'manual'">{{ datos.ciudadOrigenComercio || 'Caravelí' }}</span>, desde donde abastecen las bodegas locales con mercancías diversas. Este sistema de intermediación permite que los pobladores de <span [appDataSource]="'section'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> accedan a una variedad más amplia de productos, aunque la oferta sigue siendo limitada en comparación con las zonas urbanas más grandes. La falta de un mercado formal y de una infraestructura de comercio mayor limita el desarrollo del intercambio comercial en la localidad, pero el dinamismo de las pequeñas bodegas y la llegada de comerciantes externos contribuyen a mantener un flujo de productos que satisface las necesidades básicas de la población.</p>

<app-image-upload
    *ngIf="fotografiasMercadoCache.length > 0"
    [fotografias]="getFotografiasMercadoParaImageUpload()"
    [sectionId]="'3.1.4.B.1.3'"
    [photoPrefix]="'fotografiaMercado'"
    [modoVista]="true"
    [permitirMultiples]="true"
    [mostrarNumero]="true"
    [mostrarTitulo]="true"
    [mostrarFuente]="true">
</app-image-upload>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>b. Hábitos de consumo</strong></p>
<p class="text-justify" *ngIf="datos.textoHabitosConsumo && datos.textoHabitosConsumo !== '____'">{{ datos.textoHabitosConsumo }}</p>
<p class="text-justify" *ngIf="!datos.textoHabitosConsumo || datos.textoHabitosConsumo === '____'">En la capital distrital de <span [appDataSource]="'distritoSeleccionado' | dataSource" [fieldName]="'distritoSeleccionado'">{{ datos.distritoSeleccionado || 'Cahuacho' }}</span>, los hábitos de consumo están basados principalmente en alimentos tradicionales y accesibles dentro de la comunidad. Los productos más consumidos incluyen tubérculos (como papa y oca) y verduras, los cuales son esenciales en la dieta diaria de los hogares. Estos productos se adquieren tanto a través de la producción local, como es el caso de la papa y la oca, como de compras a pequeños comerciantes que llegan a la capital distrital desde <span [appDataSource]="'manual'">{{ datos.ciudadOrigenComercio || 'Caravelí' }}</span>. La papa, por ser uno de los cultivos más abundantes en la zona, tiene un rol fundamental en la alimentación, acompañando la mayoría de las comidas junto a otros carbohidratos.</p>
<p class="text-justify" *ngIf="!datos.textoHabitosConsumo || datos.textoHabitosConsumo === '____'">En cuanto al consumo de proteínas, los habitantes del pueblo suelen recurrir a la carne de animales menores como las gallinas y los cuyes, así como de vacuno, los cuales son criados en sus propias viviendas. Estas carnes son un complemento importante en la dieta y una fuente de nutrientes esenciales, especialmente en eventos familiares o festividades. Si bien se consumen otros tipos de carne en menor proporción, como ovino, estas son generalmente reservadas para ocasiones especiales. Los hábitos de consumo en esta localidad reflejan una combinación de autosuficiencia en algunos alimentos, y la dependencia de productos traídos por comerciantes para completar la dieta diaria.</p>
<p class="text-justify" *ngIf="!datos.textoHabitosConsumo || datos.textoHabitosConsumo === '____'">Por otra parte, cabe mencionar que en el CP <span [appDataSource]="'section'" [fieldName]="'textoHabitosConsumo'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> se preparan diversos platos tradicionales, comúnmente durante las festividades o en ocasiones especiales. Entre ellos destacan el cuy chactado, el picante de cuy, sopa de morón con charqui, picante de quinua, mazamorra de quinua y chicha de cebada.</p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>
</div>

<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">B.1.3. Actividades económicas de la población</h4>
    
    <div class="form-group-section" style="margin-top: 20px;">
      <h4 class="section-title">Editar Párrafos</h4>
      
      <app-paragraph-editor
        fieldId="textoIntroActividadesEconomicasAISI"
        label="Actividades Económicas - Introducción - Texto Completo"
        hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
        [rows]="4"
        [value]="obtenerTextoIntroActividadesEconomicasAISI()"
        (valueChange)="onFieldChange('textoIntroActividadesEconomicasAISI', $event)">
      </app-paragraph-editor>
    </div>

    <div class="form-field" style="margin-top: 20px;">
      <label class="label">Tabla PEA Ocupada según actividad económica</label>
      <app-dynamic-table
        [datos]="datos"
        [config]="actividadesEconomicasConfig"
        [columns]="[
          { field: 'actividad', label: 'Actividad Económica', type: 'text', placeholder: 'Ej: Agricultura, ganadería, silvicultura y pesca' },
          { field: 'casos', label: 'Casos', type: 'number', placeholder: '0' },
          { field: 'porcentaje', label: 'Porcentaje', type: 'text', placeholder: '0,00 %', readonly: true }
        ]"
        [tablaKey]="'actividadesEconomicasAISI'"
        [totalKey]="'actividad'"
        [customFieldChangeHandler]="onActividadesEconomicasFieldChange.bind(this)"
        (tableUpdated)="onActividadesEconomicasTableUpdated()">
      </app-dynamic-table>

      <div class="table-editor" style="margin-top: 10px; padding: 10px; background-color: #f9f9f9; border: 1px solid #ddd;">
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; align-items: center;">
          <div>
            <label class="label">Actividad Económica</label>
            <input type="text" class="input" value="Total" readonly style="background-color: #e8e8e8;">
          </div>
          <div>
            <label class="label">Casos</label>
            <input type="text" class="input" [value]="getTotalActividadesEconomicas()" readonly style="background-color: #e8e8e8;">
          </div>
          <div>
            <label class="label">Porcentaje</label>
            <input type="text" class="input" value="100,00 %" readonly style="background-color: #e8e8e8;">
          </div>
        </div>
      </div>
    </div>

    <div class="form-group-section" style="margin-top: 20px;">
      <h4 class="section-title">Editar Párrafos</h4>
      
      <app-paragraph-editor
        fieldId="textoActividadesEconomicasAISI"
        label="Actividades Económicas - Análisis - Texto Completo"
        hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
        [rows]="4"
        [value]="obtenerTextoActividadesEconomicasAISI()"
        (valueChange)="onFieldChange('textoActividadesEconomicasAISI', $event)">
      </app-paragraph-editor>
    </div>

    <div class="form-field" style="margin-top: 20px;">
      <label class="label">Fotografías de Actividades Económicas</label>
      <app-image-upload
        [fotografias]="fotografiasActividadesEconomicasForm"
        [sectionId]="'3.1.4.B.1.3'"
        [photoPrefix]="'fotografiaActividadesEconomicas'"
        [permitirMultiples]="true"
        labelTitulo="Título de la fotografía"
        labelFuente="Fuente de la fotografía"
        labelImagen="Fotografía - Imagen"
        placeholderTitulo="Ej: Actividades económicas del CP"
        placeholderFuente="Ej: GEADES, 2024"
        tituloDefault="Actividades Económicas del CP"
        fuenteDefault="GEADES, 2024"
        [requerido]="false"
        (fotografiasChange)="onFotografiasActividadesEconomicasChange($event)">
      </app-image-upload>
    </div>

    <div class="form-group-section" style="margin-top: 30px;">
      <h4 class="section-title">a. Mercado y comercialización de productos</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoMercadoProductos"
          label="Mercado y comercialización - Texto Completo"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="6"
          [value]="obtenerTextoMercadoProductos()"
          (valueChange)="onFieldChange('textoMercadoProductos', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Ciudad de origen del comercio</label>
        <input type="text" class="input" 
          [value]="datos['ciudadOrigenComercio'] || ''"
          (input)="onFieldChange('ciudadOrigenComercio', $any($event.target).value)"
          placeholder="Ej: Caravelí">
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Mercado</label>
        <app-image-upload
          [fotografias]="fotografiasMercadoForm"
          [sectionId]="'3.1.4.B.1.3'"
          [photoPrefix]="'fotografiaMercado'"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Bodega en el CP"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Bodega en el CP"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasMercadoChange($event)">
        </app-image-upload>
      </div>
    </div>

    <div class="form-group-section" style="margin-top: 30px;">
      <h4 class="section-title">b. Hábitos de consumo</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoHabitosConsumo"
          label="Hábitos de consumo - Texto Completo"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="8"
          [value]="obtenerTextoHabitosConsumo()"
          (valueChange)="onFieldChange('textoHabitosConsumo', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Hábitos de Consumo</label>
        <app-image-upload
          [fotografias]="fotografiasHabitosConsumoForm"
          [sectionId]="seccionId"
          [photoPrefix]="PHOTO_PREFIX"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Hábitos de consumo"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Hábitos de consumo"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasChange($event)">
        </app-image-upload>
      </div>
    </div>
  </div>
</div>
