<div class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">{{ SECCION25_TEMPLATES.tituloSeccion }}</h4>

    <label class="label">{{ SECCION25_TEMPLATES.labelTextoVivienda }}</label>
    <app-paragraph-editor
      fieldId="textoViviendaAISI"
      [value]="textoVivienda.value()"
      (valueChange)="textoVivienda.update($event)">
    </app-paragraph-editor>

    <div class="form-group" style="margin-bottom: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoCuadroTitulo }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroTituloTiposVivienda.value()"
        (change)="cuadroTituloTiposVivienda.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderTituloTiposVivienda">
    </div>

    <label class="label">{{ SECCION25_TEMPLATES.columnCategoria }} / {{ SECCION25_TEMPLATES.columnCasos }}</label>
    <app-dynamic-table
      [datos]="datos"
      [sectionId]="seccionId"
      [config]="tiposViviendaConfig"
      [columns]="[
        { field: 'categoria', label: SECCION25_TEMPLATES.columnCategoria, type: 'text', placeholder: SECCION25_TEMPLATES.placeholderCategoriaVivienda },
        { field: 'casos', label: SECCION25_TEMPLATES.columnCasos, type: 'number', placeholder: SECCION25_TEMPLATES.placeholderCasos },
        { field: 'porcentaje', label: SECCION25_TEMPLATES.columnPorcentaje, type: 'text', placeholder: SECCION25_TEMPLATES.placeholderPorcentaje, readonly: true }
      ]"
      [tablaKey]="'tiposViviendaAISI'"
      [totalKey]="'categoria'"
      [customFieldChangeHandler]="onTiposViviendaFieldChange.bind(this)"
      (tableUpdated)="onTiposViviendaTableUpdated()">
    </app-dynamic-table>

    <div class="form-group" style="margin-top: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoFuente }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroFuenteTiposVivienda.value()"
        (change)="cuadroFuenteTiposVivienda.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderFuenteTiposVivienda">
    </div>

    <!-- Texto — Ocupación (ahora después del cuadro) -->
    <label class="label">{{ SECCION25_TEMPLATES.labelTextoOcupacion }}</label>
    <app-paragraph-editor
      fieldId="textoOcupacionViviendaAISI"
      [value]="textoOcupacion.value()"
      (valueChange)="textoOcupacion.update($event)">
    </app-paragraph-editor>

    <!-- Tablas -->
    <h5 class="mt-md">{{ SECCION25_TEMPLATES.labelCuadros }}</h5>

    <div class="form-group" style="margin-bottom: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoCuadroTitulo }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroTituloCondicionOcupacion.value()"
        (change)="cuadroTituloCondicionOcupacion.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderTituloCondicionOcupacion">
    </div>

    <label class="label">{{ SECCION25_TEMPLATES.columnCategoria }} / {{ SECCION25_TEMPLATES.columnCasos }}</label>
    <app-dynamic-table
      [datos]="datos"
      [sectionId]="seccionId"
      [config]="condicionOcupacionConfig"
      [columns]="[
        { field: 'categoria', label: SECCION25_TEMPLATES.columnCategoria, type: 'text', placeholder: SECCION25_TEMPLATES.placeholderCategoriaOcupacion },
        { field: 'casos', label: SECCION25_TEMPLATES.columnCasos, type: 'number', placeholder: SECCION25_TEMPLATES.placeholderCasos },
        { field: 'porcentaje', label: SECCION25_TEMPLATES.columnPorcentaje, type: 'text', placeholder: SECCION25_TEMPLATES.placeholderPorcentaje, readonly: true }
      ]"
      [tablaKey]="'condicionOcupacionAISI'"
      [totalKey]="'categoria'"
      [customFieldChangeHandler]="onCondicionOcupacionFieldChange.bind(this)"
      (tableUpdated)="onCondicionOcupacionTableUpdated()"
    >
    </app-dynamic-table>

    <div class="form-group" style="margin-top: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoFuente }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroFuenteCondicionOcupacion.value()"
        (change)="cuadroFuenteCondicionOcupacion.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderFuenteCondicionOcupacion">
    </div>

    <h4 class="section-title">{{ SECCION25_TEMPLATES.labelEstructura }}</h4>

    <label class="label">{{ SECCION25_TEMPLATES.labelTextoEstructura }}</label>
    <app-paragraph-editor
      fieldId="textoEstructuraAISI"
      [value]="textoEstructura.value()"
      (valueChange)="textoEstructura.update($event)">
    </app-paragraph-editor>

    <div class="form-group" style="margin-bottom: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoCuadroTitulo }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroTituloMaterialesVivienda.value()"
        (change)="cuadroTituloMaterialesVivienda.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderTituloMaterialesVivienda">
    </div>

    <label class="label">{{ SECCION25_TEMPLATES.columnCategoria }} / {{ SECCION25_TEMPLATES.columnTipoMaterial }}</label>
    <app-dynamic-table
      [datos]="datos"
      [sectionId]="seccionId"
      [config]="materialesViviendaConfig"
      [columns]="[
        { field: 'categoria', label: SECCION25_TEMPLATES.columnCategoria, type: 'text', placeholder: 'Ej: Materiales de las paredes de las viviendas' },
        { field: 'subcategoria', label: SECCION25_TEMPLATES.columnTipoMaterial, type: 'text', placeholder: 'Ej: Adobe' },
        { field: 'casos', label: SECCION25_TEMPLATES.columnCasos, type: 'number', placeholder: SECCION25_TEMPLATES.placeholderCasos },
        { field: 'porcentaje', label: SECCION25_TEMPLATES.columnPorcentaje, type: 'text', placeholder: SECCION25_TEMPLATES.placeholderPorcentaje, readonly: true }
      ]"
      [tablaKey]="'materialesViviendaAISI'"
      [modoVista]="false"
      (tableUpdated)="onMaterialesViviendaTableUpdated()">
    </app-dynamic-table>

    <div class="form-group" style="margin-top: 15px;">
      <label class="label">{{ SECCION25_TEMPLATES.labelTextoFuente }}</label>
      <input 
        type="text" 
        class="form-control"
        [value]="cuadroFuenteMaterialesVivienda.value()"
        (change)="cuadroFuenteMaterialesVivienda.update($any($event.target).value)"
        [placeholder]="SECCION25_TEMPLATES.placeholderFuenteMaterialesVivienda">
    </div>

    <div class="form-field" style="margin-top: 20px;">
      <label class="label">Fotografías</label>
      <app-image-upload
        [fotografias]="viewModel().fotos"
        [sectionId]="seccionId"
        [photoPrefix]="PHOTO_PREFIX"
        [permitirMultiples]="true"
        labelTitulo="Título de la fotografía"
        labelFuente="Fuente de la fotografía"
        labelImagen="Fotografía - Imagen"
        placeholderTitulo="Ej: Estructura de viviendas en el CP"
        placeholderFuente="Ej: GEADES, 2024"
        tituloDefault="Estructura de viviendas en el CP"
        fuenteDefault="GEADES, 2024"
        [requerido]="false"
        (fotografiasChange)="onFotografiasChangeHandler($event)">
      </app-image-upload>
    </div>

  </div>
</div>
