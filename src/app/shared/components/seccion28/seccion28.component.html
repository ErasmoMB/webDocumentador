<div *ngIf="!modoFormulario">
<h5>B.1.7. Infraestructura en salud, educación, recreativa y deportiva</h5>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>a. Infraestructura en salud</strong></p>
<p class="text-justify" *ngIf="datos.textoSaludCP && datos.textoSaludCP !== '____'">{{ datos.textoSaludCP }}</p>
<p class="text-justify" *ngIf="!datos.textoSaludCP || datos.textoSaludCP === '____'">Dentro de la capital distrital de <span [appDataSource]="'section'" [fieldName]="'distritoSeleccionado'">{{ datos.distritoSeleccionado || 'Cahuacho' }}</span> se encuentra un único establecimiento de salud de categoría I-2, que brinda atención primaria a la población local. Este puesto de salud es el principal punto de referencia para los habitantes de <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span>, ofreciendo servicios esenciales como consultas médicas, controles de salud y atención básica de emergencias. Aunque cuenta con limitaciones en cuanto a especialidades médicas y equipamiento, su presencia es fundamental para atender las necesidades de salud de la población, especialmente considerando la ausencia de otros centros de mayor capacidad en la zona.</p>

<app-table-wrapper title="Principales características del Puesto de Salud {{ datos.centroPobladoAISI || 'Cahuacho' }}" sectionId="3.1.4.B.1.7">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Categoría</th>
            <th class="table-header">Descripción</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of (datos.puestoSaludCpTabla || [])">
            <td class="table-cell" [appDataSource]="'manual'" [fieldName]="'categoria'">{{ item.categoria || '____' }}</td>
            <td class="table-cell" [appDataSource]="'manual'" [fieldName]="'descripcion'">{{ item.descripcion || '____' }}</td>
        </tr>
        <tr *ngIf="!datos.puestoSaludCpTabla || datos.puestoSaludCpTabla.length === 0">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">FUENTE:<span [appDataSource]="'manual'"> GEADES (2024)</span></p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasSaludVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX_SALUD"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>b. Infraestructura en educación</strong></p>
<p class="text-justify" *ngIf="datos.textoEducacionCP && datos.textoEducacionCP !== '____'">{{ datos.textoEducacionCP }}</p>
<p class="text-justify" *ngIf="!datos.textoEducacionCP || datos.textoEducacionCP === '____'">Dentro del CP <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> se hallan instituciones educativas que cubren todos los niveles de educación básica regular: inicial, primaria y secundaria. En base al Censo Educativo 2023, la institución con mayor cantidad de estudiantes dentro de la localidad es la <span [appDataSource]="'manual'" [fieldName]="'nombreIEMayorEstudiantes'">{{ datos.nombreIEMayorEstudiantes || 'IE Virgen de Copacabana' }}</span>, la cual es de nivel secundaria, con un total de <span [appDataSource]="'section'" [fieldName]="'cantidadEstudiantesIEMayor'">{{ datos.cantidadEstudiantesIEMayor || '28' }}</span> estudiantes. A continuación, se presenta el cuadro con la cantidad de estudiantes por institución educativa y nivel dentro de la localidad en cuestión.</p>

<app-table-wrapper title="Infraestructura educativa – CP {{ datos.centroPobladoAISI || 'Cahuacho' }} (2023)" sectionId="3.1.4.B.1.7">
<table class="table-container">
    <thead>
        <tr>
            <th class="table-header">Nombre de IE</th>
            <th class="table-header">Nivel</th>
            <th class="table-header">Tipo de Gestión</th>
            <th class="table-header">Cantidad de estudiantes</th>
            <th class="table-header">Porcentaje</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of getEducacionSinTotal()">
            <td class="table-cell" [appDataSource]="'manual'" [fieldName]="'nombreIE'">{{ item.nombreIE || '____' }}</td>
            <td class="table-cell cell-from-bd" [appDataSource]="'backend'" [fieldName]="'nivel'">{{ item.nivel || '____' }}</td>
            <td class="table-cell" [appDataSource]="'manual'" [fieldName]="'tipoGestion'">{{ item.tipoGestion || '____' }}</td>
            <td class="table-cell cell-from-bd" [appDataSource]="'backend'" [fieldName]="'cantidadEstudiantes'">{{ item.cantidadEstudiantes || '____' }}</td>
            <td class="table-cell cell-percentage" [appDataSource]="'section'" [fieldName]="'porcentaje'">{{ calcularPorcentajeEducacion(item) }}</td>
        </tr>
        <tr *ngIf="getEducacionSinTotal().length > 0">
            <td class="table-cell" colspan="3"><strong>Total</strong></td>
            <td class="table-cell"><strong>{{ getTotalEducacion() }}</strong></td>
            <td class="table-cell"><strong>100,00 %</strong></td>
        </tr>
        <tr *ngIf="getEducacionSinTotal().length === 0">
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
            <td class="table-cell">____</td>
        </tr>
    </tbody>
</table>
</app-table-wrapper>
<p class="source">FUENTE:<span [appDataSource]="'manual'"> Censo Educativo 2023 – ESCALE (MINEDU)</span></p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasEducacionVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX_EDUCACION"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>c. Infraestructura en recreación</strong></p>
<p class="text-justify" *ngIf="datos.textoRecreacionCP1 && datos.textoRecreacionCP1 !== '____'">{{ datos.textoRecreacionCP1 }}</p>
<p class="text-justify" *ngIf="!datos.textoRecreacionCP1 || datos.textoRecreacionCP1 === '____'">Dentro del CP <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> se cuenta con espacios destinados a la recreación de la población. Entre ellos destacan las plazas, las cuales funcionan como principales áreas de encuentro para la interacción y socialización, especialmente durante festividades y eventos culturales.</p>
<p class="text-justify" *ngIf="datos.textoRecreacionCP2 && datos.textoRecreacionCP2 !== '____'">{{ datos.textoRecreacionCP2 }}</p>
<p class="text-justify" *ngIf="!datos.textoRecreacionCP2 || datos.textoRecreacionCP2 === '____'">Otra infraestructura recreativa relevante es la plaza de toros, que se halla en la zona este del centro poblado, y es un punto de gran relevancia cultural; en especial, durante las festividades patronales y celebraciones taurinas. Este espacio funciona como un centro de actividad importante para las festividades taurinas y celebraciones especiales, atrayendo tanto a residentes como a visitantes y promoviendo las tradiciones locales.</p>
<p class="text-justify" *ngIf="datos.textoRecreacionCP3 && datos.textoRecreacionCP3 !== '____'">{{ datos.textoRecreacionCP3 }}</p>
<p class="text-justify" *ngIf="!datos.textoRecreacionCP3 || datos.textoRecreacionCP3 === '____'">Adicionalmente, cabe mencionar el mirador ubicado en el cerro Pilluni, el cual ofrece vistas panorámicas de la capital distrital y los paisajes circundantes. Este lugar es un punto de interés tanto para los residentes como para los visitantes, permitiendo disfrutar de la belleza natural y de actividades recreativas al aire libre, fortaleciendo la identidad comunitaria.</p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasRecreacionVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX_RECREACION"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>

<p style="margin-top: 20px; margin-bottom: 10px;"><strong>d. Infraestructura en deporte</strong></p>
<p class="text-justify" *ngIf="datos.textoDeporteCP1 && datos.textoDeporteCP1 !== '____'">{{ datos.textoDeporteCP1 }}</p>
<p class="text-justify" *ngIf="!datos.textoDeporteCP1 || datos.textoDeporteCP1 === '____'">En el CP <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span>, la infraestructura deportiva consiste en instalaciones básicas para la práctica de actividades físicas y recreativas. Se destaca la losa deportiva ubicada detrás de la municipalidad, la cual es utilizada para diversos deportes colectivos como fútbol y vóley, y sirve como un espacio frecuente para eventos locales y recreación de niños y jóvenes.</p>
<p class="text-justify" *ngIf="datos.textoDeporteCP2 && datos.textoDeporteCP2 !== '____'">{{ datos.textoDeporteCP2 }}</p>
<p class="text-justify" *ngIf="!datos.textoDeporteCP2 || datos.textoDeporteCP2 === '____'">Asimismo, cabe mencionar que en <span [appDataSource]="'section'" [fieldName]="'centroPobladoAISI'">{{ datos.centroPobladoAISI || 'Cahuacho' }}</span> se cuenta con un "estadio", caracterizado por un campo extenso con pasto y tierra, utilizado principalmente para fútbol y otros deportes al aire libre. Este campo no cuenta con infraestructura adicional como cerco perimetral o gradas, lo que limita su capacidad para eventos formales de gran envergadura. A pesar de ello, el campo es utilizado para actividades recreativas y eventos locales, funcionando como un punto de encuentro comunitario en fechas especiales.</p>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasDeporteVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX_DEPORTE"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>

<app-image-upload
    [modoVista]="true"
    [permitirMultiples]="true"
    [fotografias]="getFotografiasVista()"
    [sectionId]="seccionId"
    [photoPrefix]="PHOTO_PREFIX"
    [labelTitulo]="'Título'"
    [labelFuente]="'Fuente'"
    [labelImagen]="'Imagen'">
</app-image-upload>
</div>

<div *ngIf="modoFormulario" class="seccion-formulario-content">
  <div class="form-group-section">
    <h4 class="section-title">B.1.7. Infraestructura en salud, educación, recreativa y deportiva</h4>
    
    <div class="form-group-section" style="margin-top: 20px;">
      <h4 class="section-title">a. Infraestructura en salud</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoSaludCP"
          label="Infraestructura en Salud - Texto Completo"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="4"
          [value]="obtenerTextoSaludCP()"
          (valueChange)="onFieldChange('textoSaludCP', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Tabla Principales características del Puesto de Salud</label>
        <app-dynamic-table
          [datos]="datos"
          [config]="puestoSaludConfig"
          [columns]="[
            { field: 'categoria', label: 'Categoría', type: 'text', placeholder: 'Ej: Nombre' },
            { field: 'descripcion', label: 'Descripción', type: 'text', placeholder: 'Ej: Puesto de Salud Cahuacho' }
          ]"
          [tablaKey]="'puestoSaludCpTabla'"
          [totalKey]="'categoria'"
          (tableUpdated)="cdRef.detectChanges()">
        </app-dynamic-table>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Infraestructura en salud</label>
        <app-image-upload
          [fotografias]="fotografiasSaludFormMulti"
          [sectionId]="seccionId"
          [photoPrefix]="PHOTO_PREFIX_SALUD"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Puesto de Salud"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Puesto de Salud"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasSaludChange($event)">
        </app-image-upload>
      </div>
    </div>

    <div class="form-group-section" style="margin-top: 30px;">
      <h4 class="section-title">b. Infraestructura en educación</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoEducacionCP"
          label="Infraestructura en Educación - Texto Completo"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="4"
          [value]="obtenerTextoEducacionCP()"
          (valueChange)="onFieldChange('textoEducacionCP', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-row" style="margin-top: 20px;">
        <div class="form-field">
          <label class="label">Nombre de la IE con mayor cantidad de estudiantes</label>
          <input type="text" class="input" 
            [value]="datos['nombreIEMayorEstudiantes'] || ''"
            (input)="onFieldChange('nombreIEMayorEstudiantes', $any($event.target).value)"
            placeholder="Ej: IE Virgen de Copacabana">
        </div>

        <div class="form-field">
          <label class="label">Cantidad de estudiantes de la IE con mayor cantidad</label>
          <input type="number" class="input" 
            [value]="datos['cantidadEstudiantesIEMayor'] || ''"
            (input)="onFieldChange('cantidadEstudiantesIEMayor', $any($event.target).value)"
            placeholder="Ej: 28">
        </div>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Tabla Infraestructura educativa</label>
        <app-dynamic-table
          [datos]="datos"
          [config]="educacionConfig"
          [columns]="[
            { field: 'nombreIE', label: 'Nombre de IE', type: 'text', placeholder: 'Ej: IE Cahuacho' },
            { field: 'nivel', label: 'Nivel', type: 'text', placeholder: 'Ej: Inicial - Jardín' },
            { field: 'tipoGestion', label: 'Tipo de Gestión', type: 'text', placeholder: 'Ej: Pública de gestión directa' },
            { field: 'cantidadEstudiantes', label: 'Cantidad de estudiantes', type: 'number', placeholder: '0' },
            { field: 'porcentaje', label: 'Porcentaje', type: 'text', placeholder: '0,00 %', readonly: true }
          ]"
          [tablaKey]="'educacionCpTabla'"
          [totalKey]="'nombreIE'"
          (tableUpdated)="cdRef.detectChanges()">
        </app-dynamic-table>

        <div class="table-editor" style="margin-top: 10px; padding: 10px; background-color: #f9f9f9; border: 1px solid #ddd;">
          <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; align-items: center;">
            <div>
              <label class="label">Total</label>
              <input type="text" class="input" value="Total" readonly style="background-color: #e8e8e8;">
            </div>
            <div>
              <label class="label">Cantidad de estudiantes</label>
              <input type="text" class="input" [value]="getTotalEducacion()" readonly style="background-color: #e8e8e8;">
            </div>
            <div>
              <label class="label">Porcentaje</label>
              <input type="text" class="input" value="100,00 %" readonly style="background-color: #e8e8e8;">
            </div>
          </div>
        </div>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Infraestructura en educación</label>
        <app-image-upload
          [fotografias]="fotografiasEducacionFormMulti"
          [sectionId]="seccionId"
          [photoPrefix]="PHOTO_PREFIX_EDUCACION"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Infraestructura educativa"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Infraestructura educativa"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasEducacionChange($event)">
        </app-image-upload>
      </div>
    </div>

    <div class="form-group-section" style="margin-top: 30px;">
      <h4 class="section-title">c. Infraestructura en recreación</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoRecreacionCP1"
          label="Infraestructura en Recreación - Párrafo 1"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="3"
          [value]="obtenerTextoRecreacionCP1()"
          (valueChange)="onFieldChange('textoRecreacionCP1', $event)">
        </app-paragraph-editor>

        <app-paragraph-editor
          fieldId="textoRecreacionCP2"
          label="Infraestructura en Recreación - Párrafo 2"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="3"
          [value]="obtenerTextoRecreacionCP2()"
          (valueChange)="onFieldChange('textoRecreacionCP2', $event)">
        </app-paragraph-editor>

        <app-paragraph-editor
          fieldId="textoRecreacionCP3"
          label="Infraestructura en Recreación - Párrafo 3"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="3"
          [value]="obtenerTextoRecreacionCP3()"
          (valueChange)="onFieldChange('textoRecreacionCP3', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Infraestructura en recreación</label>
        <app-image-upload
          [fotografias]="fotografiasRecreacionFormMulti"
          [sectionId]="seccionId"
          [photoPrefix]="PHOTO_PREFIX_RECREACION"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Plaza de toros"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Plaza de toros"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasRecreacionChange($event)">
        </app-image-upload>
      </div>
    </div>

    <div class="form-group-section" style="margin-top: 30px;">
      <h4 class="section-title">d. Infraestructura en deporte</h4>
      
      <div class="form-group-section" style="margin-top: 15px;">
        <h4 class="section-title">Editar Párrafos</h4>
        
        <app-paragraph-editor
          fieldId="textoDeporteCP1"
          label="Infraestructura en Deporte - Párrafo 1"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="3"
          [value]="obtenerTextoDeporteCP1()"
          (valueChange)="onFieldChange('textoDeporteCP1', $event)">
        </app-paragraph-editor>

        <app-paragraph-editor
          fieldId="textoDeporteCP2"
          label="Infraestructura en Deporte - Párrafo 2"
          hint="Edite el texto completo. Use Enter para crear nuevos párrafos. Deje vacío para usar el texto por defecto."
          [rows]="4"
          [value]="obtenerTextoDeporteCP2()"
          (valueChange)="onFieldChange('textoDeporteCP2', $event)">
        </app-paragraph-editor>
      </div>

      <div class="form-field" style="margin-top: 20px;">
        <label class="label">Fotografías de Infraestructura en deporte</label>
        <app-image-upload
          [fotografias]="fotografiasDeporteFormMulti"
          [sectionId]="seccionId"
          [photoPrefix]="PHOTO_PREFIX_DEPORTE"
          [permitirMultiples]="true"
          labelTitulo="Título de la fotografía"
          labelFuente="Fuente de la fotografía"
          labelImagen="Fotografía - Imagen"
          placeholderTitulo="Ej: Losa deportiva"
          placeholderFuente="Ej: GEADES, 2024"
          tituloDefault="Losa deportiva"
          fuenteDefault="GEADES, 2024"
          [requerido]="false"
          (fotografiasChange)="onFotografiasDeporteChange($event)">
        </app-image-upload>
      </div>
    </div>
  </div>
</div>
